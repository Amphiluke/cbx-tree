<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CbxTree</title>
    <style>
      html {
        color-scheme: light dark;
        font-family: system-ui, sans-serif;
      }
      [name="reading-list[]"] {
        border: 1px solid;
        margin: 20px 10px 80px;
        height: 450px;
        overflow: auto;
        padding: 8px 8px 8px 6px;
        scrollbar-width: thin;
        width: 575px;
      }
      .trees {
        display: grid;
        gap: 1em;
        grid-template-columns: 1fr 1fr;
        margin-block: 1em;
        width: fit-content;
      }
    </style>
  </head>
  <body>
    <form action="#">
      <cbx-tree name="reading-list[]">
        <script type="application/json">
          [
            {
              "title": "Epic poetry",
              "value": "epic-poetry",
              "icon": "/icons/epic.svg",
              "children": [
                {
                  "title": "Greek epic poems",
                  "value": "greek-epic-poems",
                  "icon": "/icons/greek.svg",
                  "children": [
                    {
                      "title": "Iliad, <i>by Homer</i>",
                      "value": "iliad",
                      "icon": "/icons/manuscript.svg",
                      "checked": true
                    },
                    {
                      "title": "Odyssey, <i>by Homer</i>",
                      "value": "odyssey",
                      "icon": "/icons/manuscript.svg",
                      "checked": true
                    },
                    {
                      "title": "Theogony, <i>by Hesoid</i>",
                      "value": "theogony",
                      "icon": "/icons/manuscript.svg"
                    },
                    {
                      "title": "Works and Days, <i>by Hesoid</i>",
                      "value": "works-and-days",
                      "icon": "/icons/manuscript.svg"
                    },
                    {
                      "title": "Argonautica, <i>by Apollonius of Rhodes</i>",
                      "value": "argonautica",
                      "icon": "/icons/manuscript.svg"
                    }
                  ]
                },
                {
                  "title": "Latin epic poems",
                  "value": "latin-epic-poems",
                  "icon": "/icons/latin.svg",
                  "children": [
                    {
                      "title": "Aeneid, <i>by Virgil</i>",
                      "value": "aeneid",
                      "icon": "/icons/manuscript.svg"
                    },
                    {
                      "title": "Argonautica, <i>by Gaius Valerius Flaccus</i>",
                      "value": "argonautica-latn",
                      "icon": "/icons/manuscript.svg"
                    }
                  ]
                },
                {
                  "title": "Sumerian epic poems",
                  "value": "sumerian-epic-poems",
                  "icon": "/icons/sumerian.svg",
                  "children": [
                    {
                      "title": "Epic of Gilgamesh",
                      "value": "epic-of-gilgamesh",
                      "icon": "/icons/manuscript.svg",
                      "checked": true
                    }
                  ]
                },
                {
                  "title": "Indian epic poems",
                  "value": "indian-epic-poems",
                  "icon": "/icons/indian.svg",
                  "children": [
                    {
                      "title": "Mahabharata, <i>by Vyasa</i>",
                      "value": "mahabharata",
                      "icon": "/icons/manuscript.svg",
                      "checked": true
                    },
                    {
                      "title": "Ramayana, <i>by Valmiki</i>",
                      "value": "ramayana",
                      "icon": "/icons/manuscript.svg"
                    },
                    {
                      "title": "Silappatikaram, <i>by Ilango Adigal</i>",
                      "value": "silappatikaram",
                      "icon": "/icons/manuscript.svg"
                    },
                    {
                      "title": "Manimekalai, <i>by Chithalai Chathanar</i>",
                      "value": "Manimekalai",
                      "icon": "/icons/manuscript.svg"
                    }
                  ]
                },
                {
                  "title": "English epic poems",
                  "value": "english-epic-poems",
                  "icon": "/icons/english.svg",
                  "children": [
                    {
                      "title": "Beowulf",
                      "value": "beowulf",
                      "icon": "/icons/manuscript.svg",
                      "checked": true
                    }
                  ]
                }
              ]
            },
            {
              "title": "History books",
              "value": "history-books",
              "icon": "/icons/history.svg",
              "children": [
                {
                  "title": "Greek history books",
                  "value": "greek-history-books",
                  "icon": "/icons/greek.svg",
                  "children": [
                    {
                      "title": "Histories, <i>by Herodotus</i>",
                      "value": "histories",
                      "icon": "/icons/manuscript.svg",
                      "checked": true
                    },
                    {
                      "title": "History of the Peloponnesian War, <i>by Thucydides</i>",
                      "value": "history-of-the-peloponnesian-war",
                      "icon": "/icons/manuscript.svg"
                    },
                    {
                      "title": "Hellenica, <i>by Xenophon</i>",
                      "value": "hellenica",
                      "icon": "/icons/manuscript.svg"
                    }
                  ]
                },
                {
                  "title": "Latin history books",
                  "value": "latin-history-books",
                  "icon": "/icons/latin.svg",
                  "children": [
                    {
                      "title": "Annals, <i>by Tacitus</i>",
                      "value": "annals",
                      "icon": "/icons/manuscript.svg"
                    },
                    {
                      "title": "Commentarii de Bello Gallico, <i>by Julius Caesar</i>",
                      "value": "commentarii-de-bello-gallico",
                      "icon": "/icons/manuscript.svg",
                      "checked": true
                    }
                  ]
                },
                {
                  "title": "English history books",
                  "value": "english-history-books",
                  "icon": "/icons/english.svg",
                  "children": [
                    {
                      "title": "The Chronology of Ancient Kingdoms Amended, <i>by Isaac Newton</i>",
                      "value": "the-chronology-of-ancient-kingdoms-amended",
                      "icon": "/icons/manuscript.svg"
                    }
                  ]
                }
              ]
            },
            {
              "title": "Philosophical books",
              "value": "philosophical-books",
              "icon": "/icons/philosophy.svg",
              "collapsed": true,
              "children": [
                {
                  "title": "Greek philosophical books",
                  "value": "greek-philosophical-books",
                  "icon": "/icons/greek.svg",
                  "children": [
                    {
                      "title": "Republic, <i>by Plato</i>",
                      "value": "republic",
                      "icon": "/icons/manuscript.svg"
                    },
                    {
                      "title": "On the Soul, <i>by Aristotle</i>",
                      "value": "on-the-soul",
                      "icon": "/icons/manuscript.svg"
                    },
                    {
                      "title": "Moralia, <i>by Plutarch</i>",
                      "value": "moralia",
                      "icon": "/icons/manuscript.svg"
                    }
                  ]
                },
                {
                  "title": "Latin philosophical books",
                  "value": "latin-philosophical-books",
                  "icon": "/icons/latin.svg",
                  "collapsed": true,
                  "children": [
                    {
                      "title": "De Natura Deorum, <i>by Cicero</i>",
                      "value": "de-natura-deorum",
                      "icon": "/icons/manuscript.svg"
                    },
                    {
                      "title": "Epistulae Morales ad Lucilium, <i>by Seneca</i>",
                      "value": "epistulae-morales-ad-lucilium",
                      "icon": "/icons/manuscript.svg"
                    }
                  ]
                },
                {
                  "title": "Indian philosophical books",
                  "value": "indian-philosophical-books",
                  "icon": "/icons/indian.svg",
                  "collapsed": true,
                  "children": [
                    {
                      "title": "Upanishads",
                      "value": "upanishads",
                      "icon": "/icons/manuscript.svg"
                    }
                  ]
                }
              ]
            }
          ]
        </script>
      </cbx-tree>




      <label>
        First
        <input type="text" name="first">
      </label>
      <div class="trees">
        <cbx-tree name="tree[]"></cbx-tree>
      </div>
      <label>
        Last
        <input type="text" name="last">
      </label><br>
      <button type="submit">Go</button>
      <button type="reset">Reset</button>
    </form>
    <script type="module" src="/src/cbx-tree.mjs"></script>
    <script type="module">
      const createItem = () => {
        const value = String(Math.random()).slice(2);
        const path = ['M0 0L16 8 0 16z', 'M0 0L16 0 16 16 0 16z', 'M0 8a8 8 0 1 1 0 .01z'][Math.floor(Math.random() * 3)];
        const color = `rgb(${Math.floor(Math.random() * 256)} ${Math.floor(Math.random() * 256)} ${Math.floor(Math.random() * 256)})`;
        return {
          value,
          title: `Item “${value}”`,
          checked: Math.random() > 0.5,
          icon: `data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16'><path d='${path}' fill='${color}'/></svg>`,
          children: Math.random() > 0.5 ? null : undefined,
        };
      };
      const subtreeProvider = async (value) => {
        await new Promise((resolve) => setTimeout(resolve, 3000));
        const isTopLevel = /^\d+$/.test(value);
        return [createItem(), createItem(), createItem()];
      };
      customElements.whenDefined('cbx-tree').then(() => {
        const cbxTree = document.querySelector('[name="tree[]"]');
        cbxTree.setData([createItem(), {...createItem(), children: [createItem(), createItem()]}, createItem()]);
        cbxTree.insertAdjacentHTML('afterend', `
          <cbx-tree name="tree2[]">
            <script type="application/json">
              ${JSON.stringify([createItem(), createItem(), {...createItem(), children: [createItem(), createItem()]}])}
            <\/script>
          </cbx-tree>
        `);
        cbxTree.subtreeProvider = document.querySelector('[name="tree2[]"]').subtreeProvider = subtreeProvider;
      });
    </script>
  </body>
</html>
